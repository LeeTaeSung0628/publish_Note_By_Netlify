<!DOCTYPE html> <html lang="ko"><head>
<title>Spring Batch 트러블 슈팅</title>
<base href="../..">
<meta name="pathname" content="project/hello-batch/spring-batch-트러블-슈팅.html">
<meta name="description" content="Vault_md_public - Spring Batch 트러블 슈팅">
<meta property="og:title" content="Spring Batch 트러블 슈팅">
<meta property="og:description" content="Vault_md_public - Spring Batch 트러블 슈팅">
<meta property="og:type" content="website">
<meta property="og:url" content="project/hello-batch/spring-batch-트러블-슈팅.html">
<meta property="og:image" content="app:/c9ba5480e7ab55b1c77551ab6f893fb0f3ac/C:/Users/Hello/Desktop/obsidian/Vault_md_public/사진 및 문서/output (1).png?1739424429378">
<meta property="og:site_name" content="Vault_md_public"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0"><meta charset="UTF-8"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="site-lib/rss.xml"><script async="" id="webpage-script" src="site-lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-wasm-script" src="site-lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="site-lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="site-lib/media/favicon.png"><link rel="stylesheet" href="site-lib/styles/obsidian.css"><link rel="preload" href="site-lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="site-lib/styles/theme.css"><link rel="preload" href="site-lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="site-lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/supported-plugins.css"></noscript><link rel="preload" href="site-lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="site-lib/styles/main-styles.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-vertical-spacing:1.3em;--sidebar-margin:12px}:root{background-color:#202124}.sidebar{height:100%;font-size:14px;z-index:10;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));position:relative;overflow:hidden;overflow:clip;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}#left-sidebar{left:0}#right-sidebar{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}.sidebar.floating{position:absolute}.sidebar .leaf-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .leaf-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}#left-sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}#right-sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar #left-sidebar-content,.sidebar #right-sidebar-content{contain:none!important;container-type:normal!important;animation:none!important}.sidebar:has(.leaf-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}#left-sidebar .sidebar-topbar{left:0;flex-direction:row}#right-sidebar .sidebar-topbar{right:0;flex-direction:row-reverse}#left-sidebar .topbar-content{margin-right:calc(2.3em + var(--sidebar-margin));flex-direction:row}#right-sidebar .topbar-content{margin-left:calc(2.3em + var(--sidebar-margin));flex-direction:row-reverse}.topbar-content{overflow:hidden visible;overflow:clip visible;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:2px!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}#left-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}#right-sidebar .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.feature-title{margin-left:4px;text-transform:uppercase;letter-spacing:.06em;margin-top:.75em;margin-bottom:.75em}.feature-header{display:flex;align-items:center;padding-top:0;font-size:1em;padding-left:0}body.floating-sidebars .sidebar{position:absolute}body{transition:background-color var(--color-fade-speed) ease-in-out}#layout{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}#center-content{flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0!important;transition:opacity .2s ease-in-out;pointer-events:none}#center-content>.obsidian-document{padding-left:2em;padding-right:1em;margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}body #center-content>.obsidian-document>.markdown-preview-sizer{padding-bottom:80vh;width:100%;max-width:var(--line-width);flex-basis:var(--line-width);transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document>div{width:100%!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}#center-content>.obsidian-document:not([data-type=markdown]).embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}#center-content>.obsidian-document:not([data-type=markdown]).embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6):has(> :is(.math:not(.math-inline),table)){overflow-x:auto!important}#center-content>.obsidian-document:not([data-type=markdown]){overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.obsidian-document[data-type=attachment]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;width:100%}.obsidian-document[data-type=attachment]>*{outline:0;border:none;box-shadow:none}.obsidian-document[data-type=attachment] :is(img){max-width:90%;max-height:90%;object-fit:contain}.obsidian-document[data-type=attachment]>:is(audio){width:100%;max-width:min(90%,var(--line-width))}.obsidian-document[data-type=attachment]>:is(embed,iframe,video){width:100%;height:100%;max-width:100%;max-height:100%;object-fit:contain}.canvas-wrapper>:is(.header,.footer){z-index:100;position:absolute;display:flex;justify-content:center;flex-direction:column;width:100%;align-items:center}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){let e=document.querySelectorAll("link[itemprop='include']");for(const t of e){let e=t.getAttribute("href");try{let o="";if(e.startsWith("https:")||e.startsWith("http:")||"file:"!=window.location.protocol){const l=await fetch(e);if(!l.ok){console.log("Could not include file: "+e),t?.remove();continue}o=await l.text()}else{const t=document.getElementById(btoa(encodeURI(e)));if(t){const e=JSON.parse(decodeURI(atob(t.getAttribute("value")??"")));o=e?.data??""}}let l=document.createRange().createContextualFragment(o),n=Array.from(l.children);for(let e of n)e?.classList?.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e?.classList?.remove("hide")}),10);t.before(l),t.remove(),console.log("Included text: "+o),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script")));!function e(l){let n=o[l],c=l+1;n?(n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(c),l<o.length&&n.addEventListener("load",(()=>e(c)))):l<o.length?e(c):t()}(0)}</script></head><body class="publish css-settings-manager show-inline-title show-ribbon is-focused"><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="parsed-feature-container" style="display: contents;"><link itemprop="include" href="site-lib/html/custom-head-content-content.html"></div><div id="layout"><div id="left-content" class="leaf" style="--sidebar-width: var(--sidebar-width-left);"><div id="left-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><div id="search-container"><div id="search-wrapper"><input enterkeyhint="search" type="search" spellcheck="false" placeholder="Search..."><div aria-label="Clear search" id="search-clear-button"></div></div></div></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="left-sidebar-content" class="leaf-content"><link itemprop="include" href="site-lib/html/file-tree-content.html"></div></div><script defer="">let ls = document.querySelector("#left-sidebar"); ls.classList.toggle("is-collapsed", window.innerWidth < 768); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div></div><div id="center-content" class="leaf"><div class="obsidian-document markdown-preview-view markdown-rendered node-insert-event allow-fold-headings allow-fold-lists show-indentation-guide show-properties is-readable-line-width" data-type="markdown"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><div class="header"><h1 class="page-title heading inline-title" id="Spring_Batch_트러블_슈팅_0">Spring Batch 트러블 슈팅</h1><div class="data-bar"></div></div><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="el-h1"><h1 data-heading="🙇‍♂Spring Batch 트러블 슈팅" dir="auto" class="heading" id="🙇‍♂Spring_Batch_트러블_슈팅_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>🙇‍♂Spring Batch 트러블 슈팅</h1></div><div class="el-p"><p dir="auto"><a href="?query=tag:%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#프로젝트">#프로젝트</a> <a href="?query=tag:%EA%B0%9C%EB%B0%9C" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#개발">#개발</a> <a href="?query=tag:SPRING" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#SPRING">#SPRING</a> <a href="?query=tag:Batch" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Batch">#Batch</a> <a href="?query=tag:Partitioning" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Partitioning">#Partitioning</a> <a href="?query=tag:Chunk" class="tag is-unresolved" target="_self" rel="noopener nofollow" data-href="#Chunk">#Chunk</a></p></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="작업 목적" dir="auto" class="heading" id="작업_목적_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>작업 목적</h1></div><div class="el-p"><p dir="auto">기존 예치금 차액비교 Batch의 Tasklet방식의 배치의 단점을 보완하는 chunk 방식의 배치를 구현하고,<br>
나아가 다른 기능의 Batch에도 효과적으로 빠르게 적용할 수 있는<mark>재사용성/유지보수성 높은 코드</mark>, 선례를 만들기 위함이다.</p></div><div class="el-h1"><h1 data-heading="작업 계획" dir="auto" class="heading" id="작업_계획_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>작업 계획</h1></div><div class="el-ol"><ol>
<li data-line="0" dir="auto">Chunk, Partioning방식을 Job을 추가 개발 (기존 balanceJob 유지)</li>
<li data-line="1" dir="auto">당분간 두 Job을 병행하면서 비교</li>
<li data-line="2" dir="auto">추가한 Job 기능에 문제없다면 기존 balanceJob 삭제</li>
</ol></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="예치금차액비교 Batch Job 기존 소요시간 그래프" dir="auto" class="heading" id="예치금차액비교_Batch_Job_기존_소요시간_그래프_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>예치금차액비교 Batch Job 기존 소요시간 그래프</h1></div><div class="el-h2"><h2 data-heading="2024-10-28 ~ 2024-11-19 (주말제외)" dir="auto" class="heading" id="2024-10-28_~_2024-11-19_(주말제외)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>2024-10-28 ~ 2024-11-19 (주말제외)</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><strong>평균 소요시간</strong>: 약 17.35분</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span><strong>최대 소요시간</strong>: 22분</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><strong>최소 소요시간</strong>: 12분<br>
<span alt="output (1).png" src="사진-및-문서/output-(1).png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="output (1).png" src="사진-및-문서/output-(1).png" target="_self"></span></li>
</ul></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="문제점 분석" dir="auto" class="heading" id="문제점_분석_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>문제점 분석</h1></div><div class="el-h2"><h2 data-heading="1. 하나의 트렌젝션으로 동작하며, 실패시 처음부터 재시도 해야함" dir="auto" class="heading" id="1._하나의_트렌젝션으로_동작하며,_실패시_처음부터_재시도_해야함_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>1. 하나의 트렌젝션으로 동작하며, 실패시 처음부터 재시도 해야함</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span><em>처음 가져온 Point 배치 완료시 까지 계속 물고있다.</em> -&gt; <mark>한 트렌젝션의 범위가 넓다.</mark></li>
</ul></div><div class="el-h2"><h2 data-heading="2. 한 트렌젝션내에서 긴 시간을 동작하여, 배치중 일어나는 insert/update(예치금 입금 출금) 건을 감지하지 못함" dir="auto" class="heading" id="2._한_트렌젝션내에서_긴_시간을_동작하여,_배치중_일어나는_insert/update(예치금_입금_출금)_건을_감지하지_못함_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>2. 한 트렌젝션내에서 긴 시간을 동작하여, 배치중 일어나는 insert/update(예치금 입금 출금) 건을 감지하지 못함</h2></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="배치 동작 로직" dir="auto" class="heading" id="배치_동작_로직_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>배치 동작 로직</h1></div><div class="el-h3"><h3 data-heading="7:00 -> 회원 개개인 별 비교. 문자는 9시 30분에 예약문자로 오지만, 실제 로직은 7시에 돈다" dir="auto" class="heading" id="700_->_회원_개개인_별_비교._문자는_9시_30분에_예약문자로_오지만,_실제_로직은_7시에_돈다_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>7:00 -&gt; 회원 개개인 별 비교. 문자는 9시 30분에 예약문자로 오지만, 실제 로직은 7시에 돈다</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>G5-Point 등은 처음 7시 시점에 묶여있다. 회원별로 <mark>실데이터를 건건이 api(신한)를 호출하여 비교한다. 때문에, 7시 이후에 수정된데이터를 실시간으로 반영하지 못한다.</mark></li>
</ul></div><div class="el-h4"><h4 data-heading="신한API가 main데이터." dir="auto" class="heading" id="신한API가_main데이터._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>신한API가 main데이터.</h4></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="New Batch의 주요 기술 및 목적" dir="auto" class="heading" id="New_Batch의_주요_기술_및_목적_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>New Batch의 주요 기술 및 목적</h1></div><div class="el-h2"><h2 data-heading="Partitioning" dir="auto" class="heading" id="Partitioning_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Partitioning</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>목적 : batch의 step 레벨에서의 스레드 분리 ( 병렬처리 )</li>
</ul></div><div class="el-h5"><h5 data-heading="** 프로세스(서비스 로직)단계에서 병렬처리를 하는 것과 어떠한차이가 있는가? ex) parallelStream, CompletableFuture **" dir="auto" class="heading" id="**_프로세스(서비스_로직)단계에서_병렬처리를_하는_것과_어떠한차이가_있는가?_ex)_parallelStream,_CompletableFuture_**_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong> 프로세스(서비스 로직)단계에서 병렬처리를 하는 것과 어떠한차이가 있는가? ex) parallelStream, CompletableFuture </strong></h5></div><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr">항목</th>
<th dir="ltr"><strong>Partitioning (Spring Batch)</strong></th>
<th dir="ltr"><strong>ParallelStream, CompletableFuture</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>적용 계층</strong></td>
<td dir="ltr">Batch Job의 Step 레벨</td>
<td dir="ltr">비즈니스 로직 또는 서비스 계층</td>
</tr>
<tr>
<td dir="ltr"><strong>주요 목적</strong></td>
<td dir="ltr">대용량 데이터를 병렬 처리하여 Batch 속도 개선</td>
<td dir="ltr">연산 최적화, 비동기 처리, 응답 시간 단축</td>
</tr>
<tr>
<td dir="ltr"><strong>트랜잭션 관리</strong></td>
<td dir="ltr">Spring Batch에서 제공 (트랜잭션 분리됨)</td>
<td dir="ltr">개발자가 직접 관리해야 함</td>
</tr>
<tr>
<td dir="ltr"><strong>재시작 및 복구</strong></td>
<td dir="ltr">Spring Batch가 지원</td>
<td dir="ltr">수동으로 구현 필요</td>
</tr>
<tr>
<td dir="ltr"><strong>오버헤드</strong></td>
<td dir="ltr">Spring Batch 컨텍스트 및 파티션 설정 오버헤드</td>
<td dir="ltr">상대적으로 가볍지만 트랜잭션 없음</td>
</tr>
<tr>
<td dir="ltr"><strong>복잡도</strong></td>
<td dir="ltr">설정과 파티션 정의가 복잡함</td>
<td dir="ltr">구현이 단순하고 직관적</td>
</tr>
<tr>
<td dir="ltr"><strong>에러 핸들링</strong></td>
<td dir="ltr">Spring Batch에서 관리</td>
<td dir="ltr">개발자가 별도 핸들링 필요</td>
</tr>
<tr>
<td dir="ltr"><strong>스레드 관리</strong></td>
<td dir="ltr">Spring Batch의 PartitionHandler 관리</td>
<td dir="ltr">ForkJoinPool 또는 스레드 풀 직접 관리</td>
</tr>
<tr>
<td dir="ltr"><strong>상태 관리</strong></td>
<td dir="ltr">ExecutionContext를 통해 안전하게 관리</td>
<td dir="ltr">공유 변수나 상태 관리는 개발자 책임</td>
</tr>
</tbody>
</table></div><div class="el-h3"><h3 data-heading="즉, 파티션 별로 독립적인 SlaveStep을 생성하기 떄문에 Spring Batch의 관리를 받을 수 있다." dir="auto" class="heading" id="즉,_파티션_별로_독립적인_SlaveStep을_생성하기_떄문에_Spring_Batch의_관리를_받을_수_있다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>즉, 파티션 별로 독립적인 SlaveStep을 생성하기 떄문에 Spring Batch의 관리를 받을 수 있다.</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>독립적인 <code>ExecutionContext</code>가 주어져 상태를 안전하게 관리할 수 있다.</li>
</ul></div><div class="el-h2"><h2 data-heading="Chunk" dir="auto" class="heading" id="Chunk_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Chunk</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>목적 : 각 step내의 트렌젝션 단위 분리</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>Reader / Processor / writer 가 역할을 분담</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="파티셔닝 흐름" dir="auto" class="heading" id="파티셔닝_흐름_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>파티셔닝 흐름</h1></div><div class="el-h3"><h3 data-heading="ThreadPoolSize : 동시에 실행시킬 스테리드의 개수" dir="auto" class="heading" id="ThreadPoolSize_동시에_실행시킬_스테리드의_개수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>ThreadPoolSize : 동시에 실행시킬 스테리드의 개수</h3></div><div class="el-h3"><h3 data-heading="gridSize : 실제로 제단할 사이즈(작업단위)" dir="auto" class="heading" id="gridSize_실제로_제단할_사이즈(작업단위)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>gridSize : 실제로 제단할 사이즈(작업단위)</h3></div><div class="el-h3"><h3 data-heading="QueueCapacity : 대기열 크기" dir="auto" class="heading" id="QueueCapacity_대기열_크기_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>QueueCapacity : 대기열 크기</h3></div><div class="el-h3"><h3 data-heading="MaxPoolSize : 최대 추가 스레드 풀 개수" dir="auto" class="heading" id="MaxPoolSize_최대_추가_스레드_풀_개수_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>MaxPoolSize : 최대 추가 스레드 풀 개수</h3></div><div class="el-h5"><h5 data-heading="ThreadPoolSize : 4  /  gridSize : 25" dir="auto" class="heading" id="ThreadPoolSize_4_/_gridSize_25_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>ThreadPoolSize : 4  /  gridSize : 25</h5></div><div class="el-h5"><h5 data-heading="MaxPoolSize : 4 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)" dir="auto" class="heading" id="MaxPoolSize_4_/_QueueCapacity_2_(대기열크기를_벗어나면_Exception_발생)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>MaxPoolSize : 4 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)</h5></div><div class="el-h4"><h4 data-heading="0. 250개의 데이터" dir="auto" class="heading" id="0._250개의_데이터_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>0. 250개의 데이터</h4></div><div class="el-ol"><ol start="4">
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Partition 생성</strong>: </p>
<ul class="has-list-bullet">
<li data-line="2" dir="auto"><span class="list-bullet"></span><mark>Partition 1</mark> : ID 1 ~ 25 / <mark>대기열1</mark> : ID 101 ~ 125 / <mark>대기열2</mark> : ID 201 ~ 225</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><mark>Partition 2</mark> : ID 26 ~ 50 / <mark>대기열</mark> : ID 126 ~ 150 / <mark>대기열2</mark> : ID 226 ~ 250</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><mark>Partition 3</mark> : ID 51 ~ 75 / <mark>대기열</mark> : ID 151 ~ 175 / <mark>대기열2</mark> : -</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><mark>Partition 4</mark> : ID 76 ~ 100 / <mark>대기열</mark> : ID 176 ~ 200 / <mark>대기열2</mark> : -</li>
</ul>
</li>
<li data-line="7" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>각 Partition에서 Chunk 처리</strong>:</p>
<ul class="has-list-bullet">
<li data-line="9" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Partition 1:
<ul class="has-list-bullet">
<li data-line="10" dir="auto"><span class="list-bullet"></span>Chunk 1: ID 1 ~ 10 → 커밋</li>
<li data-line="11" dir="auto"><span class="list-bullet"></span>Chunk 2: ID 11 ~ 20 → 커밋</li>
<li data-line="12" dir="auto"><span class="list-bullet"></span>Chunk 3: ID 21 ~ 25 → 커밋</li>
</ul>
</li>
<li data-line="13" dir="auto"><span class="list-bullet"></span><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Partition 2:
<ul class="has-list-bullet">
<li data-line="14" dir="auto"><span class="list-bullet"></span>Chunk 1: ID 26 ~ 35 → 커밋</li>
<li data-line="15" dir="auto"><span class="list-bullet"></span>Chunk 2: ID 36 ~ 45 → 커밋</li>
<li data-line="16" dir="auto"><span class="list-bullet"></span>Chunk 3: ID 46 ~ 50 → 커밋</li>
</ul>
</li>
<li data-line="17" dir="auto"><span class="list-bullet"></span>나머지 Partition도 동일 방식으로 처리.</li>
</ul>
</li>
<li data-line="18" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>병렬 실행</strong>:</p>
<ul class="has-list-bullet">
<li data-line="19" dir="auto"><span class="list-bullet"></span>스레드 풀 크기 = 4이므로 4개의 Partition이 동시에 실행됩니다.</li>
<li data-line="20" dir="auto"><span class="list-bullet"></span>Partition 처리 순서는 스레드 풀에서 처리되는 순서에 따라 다를 수 있음.</li>
</ul>
</li>
<li data-line="21" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>트랜잭션 관리</strong>:</p>
<ul class="has-list-bullet">
<li data-line="23" dir="auto"><span class="list-bullet"></span>각 Partition은 독립적인 트랜잭션을 가짐.</li>
<li data-line="24" dir="auto"><span class="list-bullet"></span>각 Chunk가 커밋될 때마다 트랜잭션이 종료됨.</li>
</ul>
</li>
</ol></div><div class="el-hr"><hr></div><div class="el-h3"><h3 data-heading="데이터가 늘어났을때?" dir="auto" class="heading" id="데이터가_늘어났을때?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>데이터가 늘어났을때?</h3></div><div class="el-h5"><h5 data-heading="ThreadPoolSize : 4  /  gridSize : 25" dir="auto" class="heading" id="ThreadPoolSize_4_/_gridSize_25_1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>ThreadPoolSize : 4  /  gridSize : 25</h5></div><div class="el-h5"><h5 data-heading="MaxPoolSize : 6 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)" dir="auto" class="heading" id="MaxPoolSize_6_/_QueueCapacity_2_(대기열크기를_벗어나면_Exception_발생)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>MaxPoolSize : 6 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)</h5></div><div class="el-h3"><h3 data-heading="실행 흐름:" dir="auto" class="heading" id="실행_흐름_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>실행 흐름:</h3></div><div class="el-h4"><h4 data-heading="0. 500개의 데이터" dir="auto" class="heading" id="0._500개의_데이터_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>0. 500개의 데이터</h4></div><div class="el-ol"><ol start="8">
<li data-line="0" dir="auto"><span class="list-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>
<p><strong>Partition 생성</strong>: </p>
<ul class="has-list-bullet">
<li data-line="2" dir="auto"><span class="list-bullet"></span><mark>Partition 1</mark> : ID 1 ~ 25 / <mark>대기열1</mark> : ID 101 ~ 125 / <mark>대기열2</mark> : ID 201 ~ 225</li>
<li data-line="3" dir="auto"><span class="list-bullet"></span><mark>Partition 2</mark> : ID 26 ~ 50 / <mark>대기열</mark> : ID 126 ~ 150 / <mark>대기열2</mark> : ID 226 ~ 250</li>
<li data-line="4" dir="auto"><span class="list-bullet"></span><mark>Partition 3</mark> : ID 51 ~ 75 / <mark>대기열</mark> : ID 151 ~ 175 / <mark>대기열2</mark> : ID 251 ~ 275</li>
<li data-line="5" dir="auto"><span class="list-bullet"></span><mark>Partition 4</mark> : ID 76 ~ 100 / <mark>대기열</mark> : ID 176 ~ 200 / <mark>대기열2</mark> : ID 276 ~ 300</li>
<li data-line="6" dir="auto"><span class="list-bullet"></span><strong>추가 스레드 풀 생성</strong></li>
<li data-line="7" dir="auto"><span class="list-bullet"></span><mark>Partition 5</mark> : ID 300 ~ 325 / <mark>대기열</mark> : ID 326 ~ 350 / <mark>대기열2</mark> : ID 351 ~ 375</li>
<li data-line="8" dir="auto"><span class="list-bullet"></span><strong>추가 스레드 풀 생성</strong></li>
<li data-line="9" dir="auto"><span class="list-bullet"></span><mark>Partition 6</mark> : ID 376 ~ 400 / <mark>대기열</mark> : ID 401 ~ 425 / <mark>대기열2</mark> : ID 426 ~ 450</li>
</ul>
<p><strong>모든 대기열 소모 및 최대 스레드 풀 도달 =&gt; 작업 중단 및 오류</strong></p>
</li>
</ol></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="파티셔닝 시 스레드 설정 방식 선택" dir="auto" class="heading" id="파티셔닝_시_스레드_설정_방식_선택_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>파티셔닝 시 스레드 설정 방식 선택</h1></div><div class="el-h3"><h3 data-heading="어떠한 방식을 적용하는게 속도와 안정성 면에서 효율적일지??" dir="auto" class="heading" id="어떠한_방식을_적용하는게_속도와_안정성_면에서_효율적일지??_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>어떠한 방식을 적용하는게 속도와 안정성 면에서 효율적일지??</h3></div><div class="el-h2"><h2 data-heading="처리할 컬럼 개수가 적을 때는 청크가 세분화되더라도 부하가 크지 않음." dir="auto" class="heading" id="처리할_컬럼_개수가_적을_때는_청크가_세분화되더라도_부하가_크지_않음._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>처리할 컬럼 개수가 적을 때는 청크가 세분화되더라도 부하가 크지 않음.</h2></div><div class="el-p"><p dir="auto">-&gt; 이로볼때, 쿼리작업보다 api호출작업의 소요시간이 길어보임</p></div><div class="el-h5"><h5 data-heading="SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor" dir="auto" class="heading" id="SimpleAsyncTaskExecutor_vs_ThreadPoolTaskExecutor_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor</h5></div><div class="el-table" dir="ltr" style="overflow-x: auto;"><table>
<thead>
<tr>
<th dir="ltr"><strong>특징</strong></th>
<th dir="ltr"><strong>SimpleAsyncTaskExecutor</strong></th>
<th dir="ltr"><strong>ThreadPoolTaskExecutor</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td dir="ltr"><strong>스레드 생성 방식</strong></td>
<td dir="ltr">작업(파티션 단위)마다 새 스레드 생성</td>
<td dir="ltr">스레드 풀에서 스레드를 재사용</td>
</tr>
<tr>
<td dir="ltr"><strong>스레드 개수 제한</strong></td>
<td dir="ltr">없음</td>
<td dir="ltr"><code>corePoolSize</code>, <code>maxPoolSize</code>로 제한</td>
</tr>
<tr>
<td dir="ltr"><strong>대기열 지원</strong></td>
<td dir="ltr">없음</td>
<td dir="ltr">작업 대기열(<code>queueCapacity</code>) 지원</td>
</tr>
<tr>
<td dir="ltr"><strong>대량 데이터 처리</strong></td>
<td dir="ltr">비효율적</td>
<td dir="ltr">효율적</td>
</tr>
<tr>
<td dir="ltr"><strong>스레드 관리</strong></td>
<td dir="ltr">없음</td>
<td dir="ltr">스레드 풀로 관리</td>
</tr>
<tr>
<td dir="ltr"><strong>오버헤드</strong></td>
<td dir="ltr">스레드 생성/소멸로 오버헤드 큼</td>
<td dir="ltr">스레드 재사용으로 오버헤드 적음</td>
</tr>
<tr>
<td dir="ltr"><strong>추천 사용 사례</strong></td>
<td dir="ltr">간단한 작업, 테스트용</td>
<td dir="ltr">대량 작업, 병렬 처리, 안정적 처리 필요 시</td>
</tr>
</tbody>
</table></div><div class="el-hr"><hr></div><div class="el-p"><p dir="auto">범위 - 2017-11-07 ~ 2017-12-01<br>
startDate=2017-11-07&amp;endDate=2017-12-01</p></div><div class="el-h2"><h2 data-heading="컬럼 개수 - 292개" dir="auto" class="heading" id="컬럼_개수_-_292개_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>컬럼 개수 - 292개</h2></div><div class="el-p"><p dir="auto">기존 병렬처리 : 1분 7초<br>
기존로직 : 6분 32초</p></div><div class="el-p"><p dir="auto">t:스레드 개수 / c:각 스레드별 청크 파티션 수</p></div><div class="el-h6"><h6 data-heading="SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor" dir="auto" class="heading" id="SimpleAsyncTaskExecutor_vs_ThreadPoolTaskExecutor_1"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor</h6></div><div class="el-p"><p dir="auto">SimpleAsyncTaskExecutor<br>
g4/c10 : 1분 41.586초<br>
g5/c10 : 1분 30.037초<br>
g5/c3 : 1분 28.997초<br>
g5/c1 : 1분 29.931초<br>
g8/c10 : 1분 36.019초<br>
g10/c1 : 1분 24.529초</p></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span></li>
</ul></div><div class="el-p"><p dir="auto">ThreadPoolTaskExecutor<br>
Th min/maxSize64, g64/c10 : 1분 42.848초<br>
Th min/maxSize32, g32/c10 : 1분 26.551초</p></div><div class="el-p"><p dir="auto">Th min/maxSize16, g16/c10 :<br>
1분 46.753초 / 1분 33.779초 / 2분 25.759초<br>
1분 11.668초 / 2분 5.773초 / 2분 39.553초</p></div><div class="el-p"><p dir="auto">Th min/maxSize32, g8/c20 : 3분 25.743초</p></div><div class="el-p"><p dir="auto">Th min/maxSize16, g4/c10 :  2분 29.207초 / 2분 8.004초</p></div><div class="el-h3"><h3 data-heading="정리" dir="auto" class="heading" id="정리_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>정리</h3></div><div class="el-h4"><h4 data-heading="SimpleAsyncTaskExecutor" dir="auto" class="heading" id="SimpleAsyncTaskExecutor_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>SimpleAsyncTaskExecutor</h4></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Grid사이즈(파티셔닝 갯수) 만큼 스레드 풀 계속 생성</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>파티셔닝 갯수가 많아졌을 때, 스레드 생성/소멸에 드는 오버헤드 증가</li>
</ul></div><div class="el-h4"><h4 data-heading="ThreadPoolTaskExecutor" dir="auto" class="heading" id="ThreadPoolTaskExecutor_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>ThreadPoolTaskExecutor</h4></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>최소 스레드풀 개수 / 최대 스레드풀 개수 / 대기열 큐 크기 / 유휴 시간 모두 설정가능</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>파티셔닝 갯수가 많을 경우, 처리 성능에 맞는 스레드 풀에서 대기작업으로 처리하여 오버헤드 감소</li>
</ul></div><div class="el-h3"><h3 data-heading="1. 예치금 차액 처리 건은 총 컬럼수가 많지 않다." dir="auto" class="heading" id="1._예치금_차액_처리_건은_총_컬럼수가_많지_않다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>1. 예치금 차액 처리 건은 총 컬럼수가 많지 않다.</h3></div><div class="el-h3"><h3 data-heading="2. 배치 프로젝트 특성상 동시 작업을 고려하지 않아도 된다." dir="auto" class="heading" id="2._배치_프로젝트_특성상_동시_작업을_고려하지_않아도_된다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>2. 배치 프로젝트 특성상 동시 작업을 고려하지 않아도 된다.</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>총 처리량 기준 1/n로 각 스레드에 할당시 충분히 감당한 양으로, 대기열을 사용할 필요가 없다.</li>
</ul></div><div class="el-h2"><h2 data-heading="따라서, ==SimpleAsyncTaskExecutor를== 통해 관리하는 것이 적합하다고 판단하였다." dir="auto" class="heading" id="따라서,_==SimpleAsyncTaskExecutor를==_통해_관리하는_것이_적합하다고_판단하였다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>따라서, <mark>SimpleAsyncTaskExecutor를</mark> 통해 관리하는 것이 적합하다고 판단하였다.</h2></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="청크 방식의 정확한 동작 로직" dir="auto" class="heading" id="청크_방식의_정확한_동작_로직_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>청크 방식의 정확한 동작 로직</h1></div><div class="el-h2"><h2 data-heading="1. ==리더==는 청크사이즈 만큼 반복하며, 각 반복마다 특정범위의 값을 return한다." dir="auto" class="heading" id="1._==리더==는_청크사이즈_만큼_반복하며,_각_반복마다_특정범위의_값을_return한다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>1. <mark>리더</mark>는 청크사이즈 만큼 반복하며, 각 반복마다 특정범위의 값을 return한다.</h2></div><div class="el-h2"><h2 data-heading="2. ==프로세서==는 청크사이즈와 관계없이 리더가 넘긴 return에 따라 동작을 수행한다." dir="auto" class="heading" id="2._==프로세서==는_청크사이즈와_관계없이_리더가_넘긴_return에_따라_동작을_수행한다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>2. <mark>프로세서</mark>는 청크사이즈와 관계없이 리더가 넘긴 return에 따라 동작을 수행한다.</h2></div><div class="el-h2"><h2 data-heading="3. ==롸이터==는 청크사이즈만큼 모이면, 그때 1번 동작한다." dir="auto" class="heading" id="3._==롸이터==는_청크사이즈만큼_모이면,_그때_1번_동작한다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>3. <mark>롸이터</mark>는 청크사이즈만큼 모이면, 그때 1번 동작한다.</h2></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="QuerydslPagingItemReader 적용기" dir="auto" class="heading" id="QuerydslPagingItemReader_적용기_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>QuerydslPagingItemReader 적용기</h1></div><div class="el-h2"><h2 data-heading="ItemReader 방식" dir="auto" class="heading" id="ItemReader_방식_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>ItemReader 방식</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>쿼리 호출 및 페이징 기법 직접 구현</li>
</ul></div><div class="el-h2"><h2 data-heading="PagingItemReader 방식" dir="auto" class="heading" id="PagingItemReader_방식_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>PagingItemReader 방식</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Native Query 형태로 호출하여 자동 페이징</li>
</ul></div><div class="el-h2"><h2 data-heading="QuerydslPagingItemReader (커스텀) 방식" dir="auto" class="heading" id="QuerydslPagingItemReader_(커스텀)_방식_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>QuerydslPagingItemReader (커스텀) 방식</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Spring Batch에서는 공식적으로 지원하지 않음</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>자동 페이징</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><mark>Querydsl</mark>형태로 쿼리 호출 가능</li>
</ul></div><div class="el-h3"><h3 data-heading="QuerydslPagingItemReader 방식 구현 목적" dir="auto" class="heading" id="QuerydslPagingItemReader_방식_구현_목적_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>QuerydslPagingItemReader 방식 구현 목적</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>기존(헬로)의 Querydsl기반 JPAQuery를 그대로 사용 가능</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>자동 페이징</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>그 외 Querydsl의 장점 보유</li>
</ul></div><div class="el-h3"><h3 data-heading="AbstractPagingItemReader를 상속받는 커스텀 QuerydslPagingItemReader 클래스 생성" dir="auto" class="heading" id="AbstractPagingItemReader를_상속받는_커스텀_QuerydslPagingItemReader_클래스_생성_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>AbstractPagingItemReader를 상속받는 커스텀 QuerydslPagingItemReader 클래스 생성</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>기존 PagingItemReader의 메서드를 오버라이딩 하여 사용하며,<br>
JPQL이 수행되던 부분에 코드를 수정하였다.</li>
</ul></div><div class="el-h4"><h4 data-heading="구현된 Reader" dir="auto" class="heading" id="구현된_Reader_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>구현된 Reader</h4></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token annotation punctuation">@Bean</span>  
<span class="token annotation punctuation">@Scope</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"step"</span><span class="token punctuation">,</span> proxyMode <span class="token operator">=</span> <span class="token class-name">ScopedProxyMode</span><span class="token punctuation">.</span><span class="token constant">TARGET_CLASS</span><span class="token punctuation">)</span>  
<span class="token keyword">public</span> <span class="token class-name">QuerydslPagingItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HfbatBankBalanceCheckDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">balanceReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token class-name">ExecutionContext</span> jobContext <span class="token operator">=</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span><span class="token class-name">StepSynchronizationManager</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStepExecution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getJobExecution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getExecutionContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">Date</span> startDate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">)</span> jobContext<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">START_DATE_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token class-name">Date</span> endDate <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">)</span> jobContext<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">END_DATE_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">QuerydslPagingItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>  
            entityManagerFactory<span class="token punctuation">,</span>  
            executionOrder<span class="token punctuation">,</span>  
            <span class="token constant">DEFAULT_CHUNK_SIZE</span><span class="token punctuation">,</span>  
            queryFactory <span class="token operator">-&gt;</span> repository<span class="token punctuation">.</span><span class="token function">newFindChangeBalanceMemberList</span><span class="token punctuation">(</span>  
                    startDate<span class="token punctuation">,</span>  
                    endDate  
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="QuerydslPagingItemReader를 사용하며, 다중스레드 스케줄링 하기" dir="auto" class="heading" id="QuerydslPagingItemReader를_사용하며,_다중스레드_스케줄링_하기_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>QuerydslPagingItemReader를 사용하며, 다중스레드 스케줄링 하기</h1></div><div class="el-h2"><h2 data-heading="목적" dir="auto" class="heading" id="목적_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>목적</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>각 파티션 스레드 별 종료 시간이 크게 상이하다. <mark>총 소요시간 기준 최대 약 20% 차이</mark></li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>적용 한다면, 각 스레드 별로 even하게 작업을 수행하여 총 소요시간을 줄일 수 있을것이라 판단 </li>
</ul></div><div class="el-h2"><h2 data-heading="구현 방법" dir="auto" class="heading" id="구현_방법_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>구현 방법</h2></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token constant">JOB</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">AtomicLong</span> executionOrder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicLong</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">new</span> <span class="token class-name">QuerydslPagingItemReader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>  
        entityManagerFactory<span class="token punctuation">,</span>  
        executionOrder<span class="token punctuation">,</span>  
        <span class="token constant">DEFAULT_CHUNK_SIZE</span><span class="token punctuation">,</span>  
        queryFactory <span class="token operator">-&gt;</span> repository<span class="token punctuation">.</span><span class="token function">newFindChangeBalanceMemberList</span><span class="token punctuation">(</span>  
                startDate<span class="token punctuation">,</span>  
                endDate  
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>job 레벨에서의 스레드 세이프한 전역 변수를 생성하였다.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>그 후, 각 파티션 별 리더에 인자값으로 넘긴다.</li>
</ul></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token keyword">long</span> currentExecutionOrder <span class="token operator">=</span> executionOrder<span class="token punctuation">.</span><span class="token function">getAndIncrement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">long</span> startIndex <span class="token operator">=</span> <span class="token punctuation">(</span>currentExecutionOrder<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">int</span> totalRecords <span class="token operator">=</span> stepContext<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"totalRecords"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token keyword">if</span> <span class="token punctuation">(</span>startIndex <span class="token operator">&gt;=</span> totalRecords<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token function">initResults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 빈 결과로 초기화  </span>
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">return</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>  
  
<span class="token keyword">int</span> chunkSizeToRead <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token function">getPageSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>totalRecords <span class="token operator">-</span> startIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 남은 데이터 크기만큼 읽기  </span>
  
<span class="token comment">// QueryDSL Query 생성  </span>
<span class="token class-name">JPQLQuery</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> query <span class="token operator">=</span> <span class="token function">createQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  
        <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">)</span>  
        <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>chunkSizeToRead<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="스레드 세이프한 해당 변수는 각 페이징 리더의 startIndex를 지정 한 후," dir="auto" class="heading" id="스레드_세이프한_해당_변수는_각_페이징_리더의_startIndex를_지정_한_후,_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>스레드 세이프한 해당 변수는 각 페이징 리더의 startIndex를 지정 한 후,</h3></div><div class="el-h3"><h3 data-heading="즉시 값을 늘린다. getAndIncrement()" dir="auto" class="heading" id="즉시_값을_늘린다._getAndIncrement()_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>즉시 값을 늘린다. getAndIncrement()</h3></div><div class="el-h2"><h2 data-heading="효과" dir="auto" class="heading" id="효과_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>효과</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>먼저 한 청크단위의 작업을 끝낸 파티션은 그 다음 작업을 즉시 할당받게 된다.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>즉, 총 처리시간 기준 <mark>가장 빨리끝난 파티션</mark>과 <mark>가장 늦게 끝난 파티션</mark>의 실행 시간 차이는 최대 한 청크사이즈를 처리하는 시간보다 크지 않게 된다.</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="메세징 처리 로직 분리" dir="auto" class="heading" id="메세징_처리_로직_분리_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>메세징 처리 로직 분리</h1></div><div class="el-h2"><h2 data-heading="1. 로직순서" dir="auto" class="heading" id="1._로직순서_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>1. 로직순서</h2></div><div class="el-h3"><h3 data-heading="메세징 처리할 데이터" dir="auto" class="heading" id="메세징_처리할_데이터_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>메세징 처리할 데이터</h3></div><div class="el-p"><p dir="auto">1차 비교 이후 차액이 발생한 녀석들의 List 를 한번 더 검증한 후,  =&gt; 추후 변경 됨<br>
검증된 녀석들을 </p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BalanceCheckResultDto</span><span class="token punctuation">&gt;</span></span> realDiffList<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">최종적인 차액 리스트에 넣는다.</p></div><div class="el-h3"><h3 data-heading="스레드 별로 따로 처리되는 녀석들을 processor의 리턴으로 writer에게 넘긴다." dir="auto" class="heading" id="스레드_별로_따로_처리되는_녀석들을_processor의_리턴으로_writer에게_넘긴다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>스레드 별로 따로 처리되는 녀석들을 processor의 리턴으로 writer에게 넘긴다.</h3></div><div class="el-p"><p dir="auto">writer는 각 프로세서의 리턴으로 받은 녀석들을 하나의 DTO List로 합쳐 메세징 처리를 하게 된다.</p></div><div class="el-hr"><hr></div><div class="el-h2"><h2 data-heading="2. 어떻게 메세지(DTO 데이터)를 취합할 것인가?" dir="auto" class="heading" id="2._어떻게_메세지(DTO_데이터)를_취합할_것인가?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>2. 어떻게 메세지(DTO 데이터)를 취합할 것인가?</h2></div><div class="el-h5"><h5 data-heading="전역으로 객체를 선언하여 append하는 방식은 스레드 세이프 하지 않기 때문에 배제하였다." dir="auto" class="heading" id="전역으로_객체를_선언하여_append하는_방식은_스레드_세이프_하지_않기_때문에_배제하였다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>전역으로 객체를 선언하여 append하는 방식은 스레드 세이프 하지 않기 때문에 배제하였다.</h5></div><div class="el-h3"><h3 data-heading="방법 1. 외부저장소를 사용한다." dir="auto" class="heading" id="방법_1._외부저장소를_사용한다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>방법 1. 외부저장소를 사용한다.</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>유지보수성이 좋다.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>환경셋팅에 리소스가 많이든다. </li>
</ul></div><div class="el-h3"><h3 data-heading="방법 2. ExecutionContext에 DTO를 직렬화 시켜 저장한다." dir="auto" class="heading" id="방법_2._ExecutionContext에_DTO를_직렬화_시켜_저장한다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>방법 2. ExecutionContext에 DTO를 직렬화 시켜 저장한다.</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>구현 레벨이 가장 쉽다</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>DTO(데이터)가 많아질 경우, 큰 리소스를 차지한다.</li>
</ul></div><div class="el-h3"><h3 data-heading="방법 3. DTO를 분해하여 기본 데이터만 저장한다." dir="auto" class="heading" id="방법_3._DTO를_분해하여_기본_데이터만_저장한다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>방법 3. DTO를 분해하여 기본 데이터만 저장한다.</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>방법 2.보다는 리소스가 적지만, 문자열 처리 시간이 추가로 소모된다.</li>
</ul></div><div class="el-h3"><h3 data-heading="방법 4. ConcurrentLinkedQueue 사용 (스레드 안전한 큐 자료구조)" dir="auto" class="heading" id="방법_4._ConcurrentLinkedQueue_사용_(스레드_안전한_큐_자료구조)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>방법 4. ConcurrentLinkedQueue 사용 (스레드 안전한 큐 자료구조)</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>높은 쓰기 성능을 갖고있다.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>동시성 문제 없이 다중 스레드에서 사용 가능하다.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span>인덱스로 접근이 불가능하다.</li>
</ul></div><div class="el-h4"><h4 data-heading="해당 방법들을 현재 프로젝트와 비교했을 때, 방법 4.가 합리적으로 보인다." dir="auto" class="heading" id="해당_방법들을_현재_프로젝트와_비교했을_때,_방법_4.가_합리적으로_보인다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>해당 방법들을 현재 프로젝트와 비교했을 때, 방법 4.가 합리적으로 보인다.</h4></div><div class="el-p"><p dir="auto">QueueManager클래스를 생성하며 공통으로 사용 가능하도록 하였고,</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token annotation punctuation">@Slf4j</span>  
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QueueManager</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>  
    <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">ConcurrentLinkedQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> sharedQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentLinkedQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
    <span class="token comment">// 데이터 추가  </span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addItemToSharedQueue</span><span class="token punctuation">(</span><span class="token class-name">T</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            sharedQueue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">이를 상속받아 특정 오브젝트를 넘길 수 있도록 하였다.</p></div><div class="el-pre"><pre class="language-java" tabindex="0"><code data-line="0" class="language-java is-loaded"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BalanceQueue</span> <span class="token keyword">extends</span> <span class="token class-name">QueueManager</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BalanceCheckResultDto</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>  
  
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BalanceCheckResultDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">getDtoFromQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getItemsFromQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="**시행착오**" dir="auto" class="heading" id="**시행착오**_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>시행착오</strong></h1></div><div class="el-h1"><h1 data-heading="Limit을 사용하지 않고 JpaPagingReader를 사용했을 때, 프로세서가 모아서 처리할 수 있는 방법이 있는가?" dir="auto" class="heading" id="Limit을_사용하지_않고_JpaPagingReader를_사용했을_때,_프로세서가_모아서_처리할_수_있는_방법이_있는가?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>Limit을 사용하지 않고 JpaPagingReader를 사용했을 때, 프로세서가 모아서 처리할 수 있는 방법이 있는가?</h1></div><div class="el-h2"><h2 data-heading="이게 정확히 무슨소리인가?" dir="auto" class="heading" id="이게_정확히_무슨소리인가?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>이게 정확히 무슨소리인가?</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>보통의 Batch 서비스라면 I/O 작업에 부하가 걸려있겠지만, 현재 예치금 차액 배치는 processor 즉, 예치금 비교 연산에서 큰 리소스를 소모하고있다.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>이에 해당하는 시간 소모를 줄이기 위해 processor(서비스로직) 을 병렬처리 함으로 최종 처리시간 단축을 꾀할 수 있을지에 대한 고민이다.</li>
<li data-line="2" dir="auto"><span class="list-bullet"></span><em>이후 설명하겠지만, 내부 병렬처리 로직은 청크의 트렌젝션을 무너뜨릴 가능성이 크므로 지양해야함.</em></li>
</ul></div><div class="el-h3"><h3 data-heading="- ==processor==는 ==reader==의 return결과로만 트리거 되기 때문에 방법이 없다." dir="auto" class="heading" id="-_==processor==는_==reader==의_return결과로만_트리거_되기_때문에_방법이_없다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>- <mark>processor</mark>는 <mark>reader</mark>의 return결과로만 트리거 되기 때문에 방법이 없다.</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20241206113120.png" src="사진-및-문서/pasted-image-20241206113120.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20241206113120.png" src="사진-및-문서/pasted-image-20241206113120.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="필수가 아니라면, ==processor==의 로직을 ==writer==에 할당하여 청크사이즈로 컨트롤 할수 있지 않을까?" dir="auto" class="heading" id="필수가_아니라면,_==processor==의_로직을_==writer==에_할당하여_청크사이즈로_컨트롤_할수_있지_않을까?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>필수가 아니라면, <mark>processor</mark>의 로직을 <mark>writer</mark>에 할당하여 청크사이즈로 컨트롤 할수 있지 않을까?</h2></div><div class="el-h4"><h4 data-heading="reader(dto) -> ~~processor~~ -> writer(dtoList)" dir="auto" class="heading" id="reader(dto)_->_~~processor~~_->_writer(dtoList)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>reader(dto) -&gt; <del>processor</del> -&gt; writer(dtoList)</h4></div><div class="el-h5"><h5 data-heading="- 구현 결과 ==reader==의 return인 dto값을 chunk사이즈 만큼 List dto로 합쳐 일괄 처리가 가능하다." dir="auto" class="heading" id="-_구현_결과_==reader==의_return인_dto값을_chunk사이즈_만큼_List_dto로_합쳐_일괄_처리가_가능하다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>- 구현 결과 <mark>reader</mark>의 return인 dto값을 chunk사이즈 만큼 List dto로 합쳐 일괄 처리가 가능하다.</h5></div><div class="el-pre"><pre><code data-line="0">소요시간 : 1분 9초
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">-&gt; 기존 limit절을 이용한 로직보다 속도가 더빠르며,<br>
JpaPagingReader를 적용한다면 중복 select횟수를 줄여 더 빨라질 것으로 예상된다.</p></div><div class="el-h3"><h3 data-heading="우려되는 점은 writer가 데이터 가공의 역할까지 맡는게, 설계 목적에 부합한지 생각해보아야 한다." dir="auto" class="heading" id="우려되는_점은_writer가_데이터_가공의_역할까지_맡는게,_설계_목적에_부합한지_생각해보아야_한다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>우려되는 점은 writer가 데이터 가공의 역할까지 맡는게, 설계 목적에 부합한지 생각해보아야 한다.</h3></div><div class="el-p"><p dir="auto">결론 : 둘 중 하나</p></div><div class="el-h5"><h5 data-heading="1. 리더,프로세서 각각 dto 1개 씩 처리 (역할 분담)" dir="auto" class="heading" id="1._리더,프로세서_각각_dto_1개_씩_처리_(역할_분담)_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>1. 리더,프로세서 각각 dto 1개 씩 처리 (역할 분담)</h5></div><div class="el-h5"><h5 data-heading="2. 프로세서 로직을 제거하여 스레드는 유지하돼, 서비스로직에서 dto list로 내부 병렬처리 로직으로 구현하기" dir="auto" class="heading" id="2._프로세서_로직을_제거하여_스레드는_유지하돼,_서비스로직에서_dto_list로_내부_병렬처리_로직으로_구현하기_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>2. 프로세서 로직을 제거하여 스레드는 유지하돼, 서비스로직에서 dto list로 내부 병렬처리 로직으로 구현하기</h5></div><div class="el-pre"><pre><code data-line="0">#### 292 컬럼
## Processor 삭제(병렬처리)로직
#### grid-size:6 / chunk-size:20
54679 ms
54416 ms
## Processor 순차처리(writer만 병렬처리) 로직

#### grid-size:6 / chunk-size:20
60440 ms
62271 ms
#### grid-size:10 / chunk-size:20
58129 ms
56723 ms
#### grid-size:16 / chunk-size:20
58595 ms
56314 ms

#### grid-size:32 / chunk-size:20
- SQLTransientConnectionException
- 스레드풀 점유갯수 초과
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h2"><h2 data-heading="데이터 상으로는 내부 병렬처리의 승리" dir="auto" class="heading" id="데이터_상으로는_내부_병렬처리의_승리_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>데이터 상으로는 내부 병렬처리의 승리</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>하지만, 이후 청크 방식 Batch의 확장성과 유지보수성을 고려하여 <mark>리더,프로세서,라이터</mark> 방식으로 구현하기로 정했다.</li>
</ul></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="청크사이즈가 다름에도 처리속도가 똑같은 이유?" dir="auto" class="heading" id="청크사이즈가_다름에도_처리속도가_똑같은_이유?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>청크사이즈가 다름에도 처리속도가 똑같은 이유?</h1></div><div class="el-h3"><h3 data-heading="예상 - 트렌젝션이 분리가 안됬나?" dir="auto" class="heading" id="예상_-_트렌젝션이_분리가_안됬나?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>예상 - 트렌젝션이 분리가 안됬나?</h3></div><div class="el-pre"><pre><code data-line="0">grid-size:12 / chunk-size:30
-
3분 22.856초
3분 23.096초

grid-size:12 / chunk-size:20
-
3분 23.546초
3분 23.784초


grid-size:12 / chunk-size:10
-
3분 24.243초
3분 22.389초
3분 24.667초
3분 24.789초

grid-size:12 / chunk-size:5
-
3분 24.953초
3분 24.353초
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-h3"><h3 data-heading="원인이 무엇일까?" dir="auto" class="heading" id="원인이_무엇일까?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>원인이 무엇일까?</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>트렌젝션 분리가 되어있지 않았기 떄문에 청크사이즈를 아무리 잘게 쪼개도 시간이 같았던 것이다.</li>
<li data-line="1" dir="auto"><span class="list-bullet"></span>그럼 트렌젝션이 분리되지 않은 이유는?</li>
</ul></div><div class="el-pre"><pre><code data-line="0">dtoList.stream().parallel()  
        .forEach(dto -&gt; {});
</code><button class="copy-code-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-copy"><rect x="8" y="8" width="14" height="14" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></pre></div><div class="el-p"><p dir="auto">parallel문으로 내부 병렬처리로직을 구현했기 때문에, chunk의 트렌젝션에서 벗어나,<br>
매 insert문 마다 커밋을 하였던 것이다.</p></div><div class="el-h2"><h2 data-heading="트렌젝션 관리시 병렬처리 로직의 사용에 주의할것." dir="auto" class="heading" id="트렌젝션_관리시_병렬처리_로직의_사용에_주의할것._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>트렌젝션 관리시 병렬처리 로직의 사용에 주의할것.</h2></div><div class="el-hr"><hr></div><div class="el-h1"><h1 data-heading="반복 TEST 중.. 커넥션풀 Time Out 문제??" dir="auto" class="heading" id="반복_TEST_중.._커넥션풀_Time_Out_문제??_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>반복 TEST 중.. 커넥션풀 Time Out 문제??</h1></div><div class="el-h3"><h3 data-heading="DB 커넥션 풀 개수 확인" dir="auto" class="heading" id="DB_커넥션_풀_개수_확인_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>DB 커넥션 풀 개수 확인</h3></div><div class="el-p"><p dir="auto">SHOW VARIABLES LIKE 'max_connections'; //최대 개수<br>
SHOW STATUS LIKE 'Threads_connected'; //사용중인 개수</p></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20241213102128.png" src="사진-및-문서/pasted-image-20241213102128.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20241213102128.png" src="사진-및-문서/pasted-image-20241213102128.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="처음 몇 번간은 정상실행 되지만, 반복 테스트 중 스레드 풀 점유 대기 타임아웃이 발생했다." dir="auto" class="heading" id="처음_몇_번간은_정상실행_되지만,_반복_테스트_중_스레드_풀_점유_대기_타임아웃이_발생했다._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>처음 몇 번간은 정상실행 되지만, 반복 테스트 중 스레드 풀 점유 대기 타임아웃이 발생했다.</h2></div><div class="el-h3"><h3 data-heading="원인은 무엇인가??" dir="auto" class="heading" id="원인은_무엇인가??_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>원인은 무엇인가??</h3></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>배치를 완료한 이후에도 스레드 풀(히카리 풀)을 반환하지 않는지 확인</li>
</ul></div><div class="el-h3"><h3 data-heading="배치를 반복할 수록 커넥션 엑티브된 ==커넥션 풀 개수가 점점 늘어나는== 모습" dir="auto" class="heading" id="배치를_반복할_수록_커넥션_엑티브된_==커넥션_풀_개수가_점점_늘어나는==_모습_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>배치를 반복할 수록 커넥션 엑티브된 <mark>커넥션 풀 개수가 점점 늘어나는</mark> 모습</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20241213102229.png" src="사진-및-문서/pasted-image-20241213102229.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20241213102229.png" src="사진-및-문서/pasted-image-20241213102229.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="원인?" dir="auto" class="heading" id="원인?_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>원인?</h2></div><div class="el-ul"><ul class="has-list-bullet">
<li data-line="0" dir="auto"><span class="list-bullet"></span>Step이 마무리될때, 적어도 Job이 마무리 될때 <mark>entityManager</mark>를 클로즈 시키는것이 자명한데, 어째서 커넥션풀이 해제되지 않는가??</li>
</ul></div><div class="el-h3"><h3 data-heading="앤티티 매니저가 클로즈 되었음에도 커넥션풀을 물고있는 모습." dir="auto" class="heading" id="앤티티_매니저가_클로즈_되었음에도_커넥션풀을_물고있는_모습._0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>앤티티 매니저가 클로즈 되었음에도 커넥션풀을 물고있는 모습.</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20241213143101.png" src="사진-및-문서/pasted-image-20241213143101.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20241213143101.png" src="사진-및-문서/pasted-image-20241213143101.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="*** **엔티티 매니저는 클로즈 될 때, 트렌젝션이 살아있다면 그 트렌젝션이 종료될때까지 기다린다**" dir="auto" class="heading" id="***_**엔티티_매니저는_클로즈_될_때,_트렌젝션이_살아있다면_그_트렌젝션이_종료될때까지_기다린다**_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span><strong>* </strong>엔티티 매니저는 클로즈 될 때, 트렌젝션이 살아있다면 그 트렌젝션이 종료될때까지 기다린다**</h2></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20241213143217.png" src="사진-및-문서/pasted-image-20241213143217.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20241213143217.png" src="사진-및-문서/pasted-image-20241213143217.png" target="_self"></span></p></div><div class="el-h2"><h2 data-heading="수정 후" dir="auto" class="heading" id="수정_후_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>수정 후</h2></div><div class="el-h3"><h3 data-heading="정상적으로 커넥션 풀이 점유 해제된 모습" dir="auto" class="heading" id="정상적으로_커넥션_풀이_점유_해제된_모습_0"><span class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></span>정상적으로 커넥션 풀이 점유 해제된 모습</h3></div><div class="el-p"><p dir="auto"><span alt="Pasted image 20241213103503.png" src="사진-및-문서/pasted-image-20241213103503.png" class="internal-embed media-embed image-embed is-loaded" target="_self"><img alt="Pasted image 20241213103503.png" src="사진-및-문서/pasted-image-20241213103503.png" target="_self"></span></p></div><div class="el-hr"><hr></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div class="footer"><div class="data-bar"></div></div></div></div></div><div id="right-content" class="leaf" style="--sidebar-width: var(--sidebar-width-right);"><div id="right-sidebar" class="sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"><label class="theme-toggle-container" for="theme-toggle-input" id=""><input class="theme-toggle-input" type="checkbox" id="theme-toggle-input"><div class="toggle-background"></div></label></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content-wrapper"><div id="right-sidebar-content" class="leaf-content"><div class="graph-view-wrapper"><div class="feature-header"><div class="feature-title">Interactive Graph</div></div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<div class="graph-icon graph-global" role="button" aria-label="Global Graph" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-git-fork"><circle cx="12" cy="18" r="3"></circle><circle cx="6" cy="6" r="3"></circle><circle cx="18" cy="6" r="3"></circle><path d="M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9"></path><path d="M12 12v3"></path></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div id="outline" class=" tree-container"><div class="feature-header"><div class="feature-title">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#Spring_Batch_트러블_슈팅_0" data-path="#Spring_Batch_트러블_슈팅_0"><div class="tree-item-inner heading-link" heading-name="Spring Batch 트러블 슈팅">Spring Batch 트러블 슈팅</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#🙇‍♂Spring_Batch_트러블_슈팅_0" data-path="#🙇‍♂Spring_Batch_트러블_슈팅_0"><div class="tree-item-inner heading-link" heading-name="🙇‍♂Spring Batch 트러블 슈팅">🙇‍♂Spring Batch 트러블 슈팅</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#작업_목적_0" data-path="#작업_목적_0"><div class="tree-item-inner heading-link" heading-name="작업 목적">작업 목적</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#작업_계획_0" data-path="#작업_계획_0"><div class="tree-item-inner heading-link" heading-name="작업 계획">작업 계획</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#예치금차액비교_Batch_Job_기존_소요시간_그래프_0" data-path="#예치금차액비교_Batch_Job_기존_소요시간_그래프_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="예치금차액비교 Batch Job 기존 소요시간 그래프">예치금차액비교 Batch Job 기존 소요시간 그래프</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#2024-10-28_~_2024-11-19_(주말제외)_0" data-path="#2024-10-28_~_2024-11-19_(주말제외)_0"><div class="tree-item-inner heading-link" heading-name="2024-10-28 ~ 2024-11-19 (주말제외)">2024-10-28 ~ 2024-11-19 (주말제외)</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#문제점_분석_0" data-path="#문제점_분석_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="문제점 분석">문제점 분석</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#1._하나의_트렌젝션으로_동작하며,_실패시_처음부터_재시도_해야함_0" data-path="#1._하나의_트렌젝션으로_동작하며,_실패시_처음부터_재시도_해야함_0"><div class="tree-item-inner heading-link" heading-name="1. 하나의 트렌젝션으로 동작하며, 실패시 처음부터 재시도 해야함">1. 하나의 트렌젝션으로 동작하며, 실패시 처음부터 재시도 해야함</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#2._한_트렌젝션내에서_긴_시간을_동작하여,_배치중_일어나는_insert/update(예치금_입금_출금)_건을_감지하지_못함_0" data-path="#2._한_트렌젝션내에서_긴_시간을_동작하여,_배치중_일어나는_insert/update(예치금_입금_출금)_건을_감지하지_못함_0"><div class="tree-item-inner heading-link" heading-name="2. 한 트렌젝션내에서 긴 시간을 동작하여, 배치중 일어나는 insert/update(예치금 입금 출금) 건을 감지하지 못함">2. 한 트렌젝션내에서 긴 시간을 동작하여, 배치중 일어나는 insert/update(예치금 입금 출금) 건을 감지하지 못함</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#배치_동작_로직_0" data-path="#배치_동작_로직_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="배치 동작 로직">배치 동작 로직</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#700_->_회원_개개인_별_비교._문자는_9시_30분에_예약문자로_오지만,_실제_로직은_7시에_돈다_0" data-path="#700_->_회원_개개인_별_비교._문자는_9시_30분에_예약문자로_오지만,_실제_로직은_7시에_돈다_0"><div class="tree-item-inner heading-link" heading-name="7:00 -> 회원 개개인 별 비교. 문자는 9시 30분에 예약문자로 오지만, 실제 로직은 7시에 돈다">7:00 -&gt; 회원 개개인 별 비교. 문자는 9시 30분에 예약문자로 오지만, 실제 로직은 7시에 돈다</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#신한API가_main데이터._0" data-path="#신한API가_main데이터._0"><div class="tree-item-inner heading-link" heading-name="신한API가 main데이터.">신한API가 main데이터.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#New_Batch의_주요_기술_및_목적_0" data-path="#New_Batch의_주요_기술_및_목적_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="New Batch의 주요 기술 및 목적">New Batch의 주요 기술 및 목적</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#Partitioning_0" data-path="#Partitioning_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Partitioning">Partitioning</div></a><div class="tree-item-children"><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#**_프로세스(서비스_로직)단계에서_병렬처리를_하는_것과_어떠한차이가_있는가?_ex)_parallelStream,_CompletableFuture_**_0" data-path="#**_프로세스(서비스_로직)단계에서_병렬처리를_하는_것과_어떠한차이가_있는가?_ex)_parallelStream,_CompletableFuture_**_0"><div class="tree-item-inner heading-link" heading-name="** 프로세스(서비스 로직)단계에서 병렬처리를 하는 것과 어떠한차이가 있는가? ex) parallelStream, CompletableFuture **"><strong> 프로세스(서비스 로직)단계에서 병렬처리를 하는 것과 어떠한차이가 있는가? ex) parallelStream, CompletableFuture </strong></div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#즉,_파티션_별로_독립적인_SlaveStep을_생성하기_떄문에_Spring_Batch의_관리를_받을_수_있다._0" data-path="#즉,_파티션_별로_독립적인_SlaveStep을_생성하기_떄문에_Spring_Batch의_관리를_받을_수_있다._0"><div class="tree-item-inner heading-link" heading-name="즉, 파티션 별로 독립적인 SlaveStep을 생성하기 떄문에 Spring Batch의 관리를 받을 수 있다.">즉, 파티션 별로 독립적인 SlaveStep을 생성하기 떄문에 Spring Batch의 관리를 받을 수 있다.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#Chunk_0" data-path="#Chunk_0"><div class="tree-item-inner heading-link" heading-name="Chunk">Chunk</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#파티셔닝_흐름_0" data-path="#파티셔닝_흐름_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="파티셔닝 흐름">파티셔닝 흐름</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#ThreadPoolSize_동시에_실행시킬_스테리드의_개수_0" data-path="#ThreadPoolSize_동시에_실행시킬_스테리드의_개수_0"><div class="tree-item-inner heading-link" heading-name="ThreadPoolSize : 동시에 실행시킬 스테리드의 개수">ThreadPoolSize : 동시에 실행시킬 스테리드의 개수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#gridSize_실제로_제단할_사이즈(작업단위)_0" data-path="#gridSize_실제로_제단할_사이즈(작업단위)_0"><div class="tree-item-inner heading-link" heading-name="gridSize : 실제로 제단할 사이즈(작업단위)">gridSize : 실제로 제단할 사이즈(작업단위)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#QueueCapacity_대기열_크기_0" data-path="#QueueCapacity_대기열_크기_0"><div class="tree-item-inner heading-link" heading-name="QueueCapacity : 대기열 크기">QueueCapacity : 대기열 크기</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#MaxPoolSize_최대_추가_스레드_풀_개수_0" data-path="#MaxPoolSize_최대_추가_스레드_풀_개수_0"><div class="tree-item-inner heading-link" heading-name="MaxPoolSize : 최대 추가 스레드 풀 개수">MaxPoolSize : 최대 추가 스레드 풀 개수</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#ThreadPoolSize_4_/_gridSize_25_0" data-path="#ThreadPoolSize_4_/_gridSize_25_0"><div class="tree-item-inner heading-link" heading-name="ThreadPoolSize : 4  /  gridSize : 25">ThreadPoolSize : 4  /  gridSize : 25</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#MaxPoolSize_4_/_QueueCapacity_2_(대기열크기를_벗어나면_Exception_발생)_0" data-path="#MaxPoolSize_4_/_QueueCapacity_2_(대기열크기를_벗어나면_Exception_발생)_0"><div class="tree-item-inner heading-link" heading-name="MaxPoolSize : 4 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)">MaxPoolSize : 4 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#0._250개의_데이터_0" data-path="#0._250개의_데이터_0"><div class="tree-item-inner heading-link" heading-name="0. 250개의 데이터">0. 250개의 데이터</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#데이터가_늘어났을때?_0" data-path="#데이터가_늘어났을때?_0"><div class="tree-item-inner heading-link" heading-name="데이터가 늘어났을때?">데이터가 늘어났을때?</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#ThreadPoolSize_4_/_gridSize_25_1" data-path="#ThreadPoolSize_4_/_gridSize_25_1"><div class="tree-item-inner heading-link" heading-name="ThreadPoolSize : 4  /  gridSize : 25">ThreadPoolSize : 4  /  gridSize : 25</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#MaxPoolSize_6_/_QueueCapacity_2_(대기열크기를_벗어나면_Exception_발생)_0" data-path="#MaxPoolSize_6_/_QueueCapacity_2_(대기열크기를_벗어나면_Exception_발생)_0"><div class="tree-item-inner heading-link" heading-name="MaxPoolSize : 6 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)">MaxPoolSize : 6 / QueueCapacity : 2 (대기열크기를 벗어나면 Exception 발생)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#실행_흐름_0" data-path="#실행_흐름_0"><div class="tree-item-inner heading-link" heading-name="실행 흐름:">실행 흐름:</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#0._500개의_데이터_0" data-path="#0._500개의_데이터_0"><div class="tree-item-inner heading-link" heading-name="0. 500개의 데이터">0. 500개의 데이터</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#파티셔닝_시_스레드_설정_방식_선택_0" data-path="#파티셔닝_시_스레드_설정_방식_선택_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="파티셔닝 시 스레드 설정 방식 선택">파티셔닝 시 스레드 설정 방식 선택</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#어떠한_방식을_적용하는게_속도와_안정성_면에서_효율적일지??_0" data-path="#어떠한_방식을_적용하는게_속도와_안정성_면에서_효율적일지??_0"><div class="tree-item-inner heading-link" heading-name="어떠한 방식을 적용하는게 속도와 안정성 면에서 효율적일지??">어떠한 방식을 적용하는게 속도와 안정성 면에서 효율적일지??</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#처리할_컬럼_개수가_적을_때는_청크가_세분화되더라도_부하가_크지_않음._0" data-path="#처리할_컬럼_개수가_적을_때는_청크가_세분화되더라도_부하가_크지_않음._0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="처리할 컬럼 개수가 적을 때는 청크가 세분화되더라도 부하가 크지 않음.">처리할 컬럼 개수가 적을 때는 청크가 세분화되더라도 부하가 크지 않음.</div></a><div class="tree-item-children"><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#SimpleAsyncTaskExecutor_vs_ThreadPoolTaskExecutor_0" data-path="#SimpleAsyncTaskExecutor_vs_ThreadPoolTaskExecutor_0"><div class="tree-item-inner heading-link" heading-name="SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor">SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#컬럼_개수_-_292개_0" data-path="#컬럼_개수_-_292개_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="컬럼 개수 - 292개">컬럼 개수 - 292개</div></a><div class="tree-item-children"><div class="tree-item" data-depth="6"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#SimpleAsyncTaskExecutor_vs_ThreadPoolTaskExecutor_1" data-path="#SimpleAsyncTaskExecutor_vs_ThreadPoolTaskExecutor_1"><div class="tree-item-inner heading-link" heading-name="SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor">SimpleAsyncTaskExecutor vs ThreadPoolTaskExecutor</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#정리_0" data-path="#정리_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="정리">정리</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#SimpleAsyncTaskExecutor_0" data-path="#SimpleAsyncTaskExecutor_0"><div class="tree-item-inner heading-link" heading-name="SimpleAsyncTaskExecutor">SimpleAsyncTaskExecutor</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#ThreadPoolTaskExecutor_0" data-path="#ThreadPoolTaskExecutor_0"><div class="tree-item-inner heading-link" heading-name="ThreadPoolTaskExecutor">ThreadPoolTaskExecutor</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#1._예치금_차액_처리_건은_총_컬럼수가_많지_않다._0" data-path="#1._예치금_차액_처리_건은_총_컬럼수가_많지_않다._0"><div class="tree-item-inner heading-link" heading-name="1. 예치금 차액 처리 건은 총 컬럼수가 많지 않다.">1. 예치금 차액 처리 건은 총 컬럼수가 많지 않다.</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#2._배치_프로젝트_특성상_동시_작업을_고려하지_않아도_된다._0" data-path="#2._배치_프로젝트_특성상_동시_작업을_고려하지_않아도_된다._0"><div class="tree-item-inner heading-link" heading-name="2. 배치 프로젝트 특성상 동시 작업을 고려하지 않아도 된다.">2. 배치 프로젝트 특성상 동시 작업을 고려하지 않아도 된다.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#따라서,_==SimpleAsyncTaskExecutor를==_통해_관리하는_것이_적합하다고_판단하였다._0" data-path="#따라서,_==SimpleAsyncTaskExecutor를==_통해_관리하는_것이_적합하다고_판단하였다._0"><div class="tree-item-inner heading-link" heading-name="따라서, ==SimpleAsyncTaskExecutor를== 통해 관리하는 것이 적합하다고 판단하였다.">따라서, <mark>SimpleAsyncTaskExecutor를</mark> 통해 관리하는 것이 적합하다고 판단하였다.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#청크_방식의_정확한_동작_로직_0" data-path="#청크_방식의_정확한_동작_로직_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="청크 방식의 정확한 동작 로직">청크 방식의 정확한 동작 로직</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#1._==리더==는_청크사이즈_만큼_반복하며,_각_반복마다_특정범위의_값을_return한다._0" data-path="#1._==리더==는_청크사이즈_만큼_반복하며,_각_반복마다_특정범위의_값을_return한다._0"><div class="tree-item-inner heading-link" heading-name="1. ==리더==는 청크사이즈 만큼 반복하며, 각 반복마다 특정범위의 값을 return한다.">1. 리더는 청크사이즈 만큼 반복하며, 각 반복마다 특정범위의 값을 return한다.</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#2._==프로세서==는_청크사이즈와_관계없이_리더가_넘긴_return에_따라_동작을_수행한다._0" data-path="#2._==프로세서==는_청크사이즈와_관계없이_리더가_넘긴_return에_따라_동작을_수행한다._0"><div class="tree-item-inner heading-link" heading-name="2. ==프로세서==는 청크사이즈와 관계없이 리더가 넘긴 return에 따라 동작을 수행한다.">2. 프로세서는 청크사이즈와 관계없이 리더가 넘긴 return에 따라 동작을 수행한다.</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#3._==롸이터==는_청크사이즈만큼_모이면,_그때_1번_동작한다._0" data-path="#3._==롸이터==는_청크사이즈만큼_모이면,_그때_1번_동작한다._0"><div class="tree-item-inner heading-link" heading-name="3. ==롸이터==는 청크사이즈만큼 모이면, 그때 1번 동작한다.">3. 롸이터는 청크사이즈만큼 모이면, 그때 1번 동작한다.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#QuerydslPagingItemReader_적용기_0" data-path="#QuerydslPagingItemReader_적용기_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="QuerydslPagingItemReader 적용기">QuerydslPagingItemReader 적용기</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#ItemReader_방식_0" data-path="#ItemReader_방식_0"><div class="tree-item-inner heading-link" heading-name="ItemReader 방식">ItemReader 방식</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#PagingItemReader_방식_0" data-path="#PagingItemReader_방식_0"><div class="tree-item-inner heading-link" heading-name="PagingItemReader 방식">PagingItemReader 방식</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#QuerydslPagingItemReader_(커스텀)_방식_0" data-path="#QuerydslPagingItemReader_(커스텀)_방식_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="QuerydslPagingItemReader (커스텀) 방식">QuerydslPagingItemReader (커스텀) 방식</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#QuerydslPagingItemReader_방식_구현_목적_0" data-path="#QuerydslPagingItemReader_방식_구현_목적_0"><div class="tree-item-inner heading-link" heading-name="QuerydslPagingItemReader 방식 구현 목적">QuerydslPagingItemReader 방식 구현 목적</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#AbstractPagingItemReader를_상속받는_커스텀_QuerydslPagingItemReader_클래스_생성_0" data-path="#AbstractPagingItemReader를_상속받는_커스텀_QuerydslPagingItemReader_클래스_생성_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="AbstractPagingItemReader를 상속받는 커스텀 QuerydslPagingItemReader 클래스 생성">AbstractPagingItemReader를 상속받는 커스텀 QuerydslPagingItemReader 클래스 생성</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#구현된_Reader_0" data-path="#구현된_Reader_0"><div class="tree-item-inner heading-link" heading-name="구현된 Reader">구현된 Reader</div></a><div class="tree-item-children"></div></div></div></div></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#QuerydslPagingItemReader를_사용하며,_다중스레드_스케줄링_하기_0" data-path="#QuerydslPagingItemReader를_사용하며,_다중스레드_스케줄링_하기_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="QuerydslPagingItemReader를 사용하며, 다중스레드 스케줄링 하기">QuerydslPagingItemReader를 사용하며, 다중스레드 스케줄링 하기</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#목적_0" data-path="#목적_0"><div class="tree-item-inner heading-link" heading-name="목적">목적</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#구현_방법_0" data-path="#구현_방법_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="구현 방법">구현 방법</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#스레드_세이프한_해당_변수는_각_페이징_리더의_startIndex를_지정_한_후,_0" data-path="#스레드_세이프한_해당_변수는_각_페이징_리더의_startIndex를_지정_한_후,_0"><div class="tree-item-inner heading-link" heading-name="스레드 세이프한 해당 변수는 각 페이징 리더의 startIndex를 지정 한 후,">스레드 세이프한 해당 변수는 각 페이징 리더의 startIndex를 지정 한 후,</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#즉시_값을_늘린다._getAndIncrement()_0" data-path="#즉시_값을_늘린다._getAndIncrement()_0"><div class="tree-item-inner heading-link" heading-name="즉시 값을 늘린다. getAndIncrement()">즉시 값을 늘린다. getAndIncrement()</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#효과_0" data-path="#효과_0"><div class="tree-item-inner heading-link" heading-name="효과">효과</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#메세징_처리_로직_분리_0" data-path="#메세징_처리_로직_분리_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="메세징 처리 로직 분리">메세징 처리 로직 분리</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#1._로직순서_0" data-path="#1._로직순서_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="1. 로직순서">1. 로직순서</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#메세징_처리할_데이터_0" data-path="#메세징_처리할_데이터_0"><div class="tree-item-inner heading-link" heading-name="메세징 처리할 데이터">메세징 처리할 데이터</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#스레드_별로_따로_처리되는_녀석들을_processor의_리턴으로_writer에게_넘긴다._0" data-path="#스레드_별로_따로_처리되는_녀석들을_processor의_리턴으로_writer에게_넘긴다._0"><div class="tree-item-inner heading-link" heading-name="스레드 별로 따로 처리되는 녀석들을 processor의 리턴으로 writer에게 넘긴다.">스레드 별로 따로 처리되는 녀석들을 processor의 리턴으로 writer에게 넘긴다.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#2._어떻게_메세지(DTO_데이터)를_취합할_것인가?_0" data-path="#2._어떻게_메세지(DTO_데이터)를_취합할_것인가?_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="2. 어떻게 메세지(DTO 데이터)를 취합할 것인가?">2. 어떻게 메세지(DTO 데이터)를 취합할 것인가?</div></a><div class="tree-item-children"><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#전역으로_객체를_선언하여_append하는_방식은_스레드_세이프_하지_않기_때문에_배제하였다._0" data-path="#전역으로_객체를_선언하여_append하는_방식은_스레드_세이프_하지_않기_때문에_배제하였다._0"><div class="tree-item-inner heading-link" heading-name="전역으로 객체를 선언하여 append하는 방식은 스레드 세이프 하지 않기 때문에 배제하였다.">전역으로 객체를 선언하여 append하는 방식은 스레드 세이프 하지 않기 때문에 배제하였다.</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#방법_1._외부저장소를_사용한다._0" data-path="#방법_1._외부저장소를_사용한다._0"><div class="tree-item-inner heading-link" heading-name="방법 1. 외부저장소를 사용한다.">방법 1. 외부저장소를 사용한다.</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#방법_2._ExecutionContext에_DTO를_직렬화_시켜_저장한다._0" data-path="#방법_2._ExecutionContext에_DTO를_직렬화_시켜_저장한다._0"><div class="tree-item-inner heading-link" heading-name="방법 2. ExecutionContext에 DTO를 직렬화 시켜 저장한다.">방법 2. ExecutionContext에 DTO를 직렬화 시켜 저장한다.</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#방법_3._DTO를_분해하여_기본_데이터만_저장한다._0" data-path="#방법_3._DTO를_분해하여_기본_데이터만_저장한다._0"><div class="tree-item-inner heading-link" heading-name="방법 3. DTO를 분해하여 기본 데이터만 저장한다.">방법 3. DTO를 분해하여 기본 데이터만 저장한다.</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#방법_4._ConcurrentLinkedQueue_사용_(스레드_안전한_큐_자료구조)_0" data-path="#방법_4._ConcurrentLinkedQueue_사용_(스레드_안전한_큐_자료구조)_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="방법 4. ConcurrentLinkedQueue 사용 (스레드 안전한 큐 자료구조)">방법 4. ConcurrentLinkedQueue 사용 (스레드 안전한 큐 자료구조)</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#해당_방법들을_현재_프로젝트와_비교했을_때,_방법_4.가_합리적으로_보인다._0" data-path="#해당_방법들을_현재_프로젝트와_비교했을_때,_방법_4.가_합리적으로_보인다._0"><div class="tree-item-inner heading-link" heading-name="해당 방법들을 현재 프로젝트와 비교했을 때, 방법 4.가 합리적으로 보인다.">해당 방법들을 현재 프로젝트와 비교했을 때, 방법 4.가 합리적으로 보인다.</div></a><div class="tree-item-children"></div></div></div></div></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#**시행착오**_0" data-path="#**시행착오**_0"><div class="tree-item-inner heading-link" heading-name="**시행착오**"><strong>시행착오</strong></div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#Limit을_사용하지_않고_JpaPagingReader를_사용했을_때,_프로세서가_모아서_처리할_수_있는_방법이_있는가?_0" data-path="#Limit을_사용하지_않고_JpaPagingReader를_사용했을_때,_프로세서가_모아서_처리할_수_있는_방법이_있는가?_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="Limit을 사용하지 않고 JpaPagingReader를 사용했을 때, 프로세서가 모아서 처리할 수 있는 방법이 있는가?">Limit을 사용하지 않고 JpaPagingReader를 사용했을 때, 프로세서가 모아서 처리할 수 있는 방법이 있는가?</div></a><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#이게_정확히_무슨소리인가?_0" data-path="#이게_정확히_무슨소리인가?_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="이게 정확히 무슨소리인가?">이게 정확히 무슨소리인가?</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#-_==processor==는_==reader==의_return결과로만_트리거_되기_때문에_방법이_없다._0" data-path="#-_==processor==는_==reader==의_return결과로만_트리거_되기_때문에_방법이_없다._0"><div class="tree-item-inner heading-link" heading-name="- ==processor==는 ==reader==의 return결과로만 트리거 되기 때문에 방법이 없다."><span>- <span><mark>processor</mark>는 <mark>reader</mark>의 return결과로만 트리거 되기 때문에 방법이 없다.</span></span></div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#필수가_아니라면,_==processor==의_로직을_==writer==에_할당하여_청크사이즈로_컨트롤_할수_있지_않을까?_0" data-path="#필수가_아니라면,_==processor==의_로직을_==writer==에_할당하여_청크사이즈로_컨트롤_할수_있지_않을까?_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="필수가 아니라면, ==processor==의 로직을 ==writer==에 할당하여 청크사이즈로 컨트롤 할수 있지 않을까?">필수가 아니라면, <mark>processor</mark>의 로직을 <mark>writer</mark>에 할당하여 청크사이즈로 컨트롤 할수 있지 않을까?</div></a><div class="tree-item-children"><div class="tree-item" data-depth="4"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#reader(dto)_->_~~processor~~_->_writer(dtoList)_0" data-path="#reader(dto)_->_~~processor~~_->_writer(dtoList)_0"><div class="tree-item-inner heading-link" heading-name="reader(dto) -> ~~processor~~ -> writer(dtoList)">reader(dto) -&gt; <del>processor</del> -&gt; writer(dtoList)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#-_구현_결과_==reader==의_return인_dto값을_chunk사이즈_만큼_List_dto로_합쳐_일괄_처리가_가능하다._0" data-path="#-_구현_결과_==reader==의_return인_dto값을_chunk사이즈_만큼_List_dto로_합쳐_일괄_처리가_가능하다._0"><div class="tree-item-inner heading-link" heading-name="- 구현 결과 ==reader==의 return인 dto값을 chunk사이즈 만큼 List dto로 합쳐 일괄 처리가 가능하다."><span>- <span>구현 결과 <mark>reader</mark>의 return인 dto값을 chunk사이즈 만큼 List dto로 합쳐 일괄 처리가 가능하다.</span></span></div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="3"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#우려되는_점은_writer가_데이터_가공의_역할까지_맡는게,_설계_목적에_부합한지_생각해보아야_한다._0" data-path="#우려되는_점은_writer가_데이터_가공의_역할까지_맡는게,_설계_목적에_부합한지_생각해보아야_한다._0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="우려되는 점은 writer가 데이터 가공의 역할까지 맡는게, 설계 목적에 부합한지 생각해보아야 한다.">우려되는 점은 writer가 데이터 가공의 역할까지 맡는게, 설계 목적에 부합한지 생각해보아야 한다.</div></a><div class="tree-item-children"><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#1._리더,프로세서_각각_dto_1개_씩_처리_(역할_분담)_0" data-path="#1._리더,프로세서_각각_dto_1개_씩_처리_(역할_분담)_0"><div class="tree-item-inner heading-link" heading-name="1. 리더,프로세서 각각 dto 1개 씩 처리 (역할 분담)">1. 리더,프로세서 각각 dto 1개 씩 처리 (역할 분담)</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#2._프로세서_로직을_제거하여_스레드는_유지하돼,_서비스로직에서_dto_list로_내부_병렬처리_로직으로_구현하기_0" data-path="#2._프로세서_로직을_제거하여_스레드는_유지하돼,_서비스로직에서_dto_list로_내부_병렬처리_로직으로_구현하기_0"><div class="tree-item-inner heading-link" heading-name="2. 프로세서 로직을 제거하여 스레드는 유지하돼, 서비스로직에서 dto list로 내부 병렬처리 로직으로 구현하기">2. 프로세서 로직을 제거하여 스레드는 유지하돼, 서비스로직에서 dto list로 내부 병렬처리 로직으로 구현하기</div></a><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#데이터_상으로는_내부_병렬처리의_승리_0" data-path="#데이터_상으로는_내부_병렬처리의_승리_0"><div class="tree-item-inner heading-link" heading-name="데이터 상으로는 내부 병렬처리의 승리">데이터 상으로는 내부 병렬처리의 승리</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#청크사이즈가_다름에도_처리속도가_똑같은_이유?_0" data-path="#청크사이즈가_다름에도_처리속도가_똑같은_이유?_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="청크사이즈가 다름에도 처리속도가 똑같은 이유?">청크사이즈가 다름에도 처리속도가 똑같은 이유?</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#예상_-_트렌젝션이_분리가_안됬나?_0" data-path="#예상_-_트렌젝션이_분리가_안됬나?_0"><div class="tree-item-inner heading-link" heading-name="예상 - 트렌젝션이 분리가 안됬나?">예상 - 트렌젝션이 분리가 안됬나?</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#원인이_무엇일까?_0" data-path="#원인이_무엇일까?_0"><div class="tree-item-inner heading-link" heading-name="원인이 무엇일까?">원인이 무엇일까?</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#트렌젝션_관리시_병렬처리_로직의_사용에_주의할것._0" data-path="#트렌젝션_관리시_병렬처리_로직의_사용에_주의할것._0"><div class="tree-item-inner heading-link" heading-name="트렌젝션 관리시 병렬처리 로직의 사용에 주의할것.">트렌젝션 관리시 병렬처리 로직의 사용에 주의할것.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="1"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#반복_TEST_중.._커넥션풀_Time_Out_문제??_0" data-path="#반복_TEST_중.._커넥션풀_Time_Out_문제??_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="반복 TEST 중.. 커넥션풀 Time Out 문제??">반복 TEST 중.. 커넥션풀 Time Out 문제??</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#DB_커넥션_풀_개수_확인_0" data-path="#DB_커넥션_풀_개수_확인_0"><div class="tree-item-inner heading-link" heading-name="DB 커넥션 풀 개수 확인">DB 커넥션 풀 개수 확인</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#처음_몇_번간은_정상실행_되지만,_반복_테스트_중_스레드_풀_점유_대기_타임아웃이_발생했다._0" data-path="#처음_몇_번간은_정상실행_되지만,_반복_테스트_중_스레드_풀_점유_대기_타임아웃이_발생했다._0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="처음 몇 번간은 정상실행 되지만, 반복 테스트 중 스레드 풀 점유 대기 타임아웃이 발생했다.">처음 몇 번간은 정상실행 되지만, 반복 테스트 중 스레드 풀 점유 대기 타임아웃이 발생했다.</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#원인은_무엇인가??_0" data-path="#원인은_무엇인가??_0"><div class="tree-item-inner heading-link" heading-name="원인은 무엇인가??">원인은 무엇인가??</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#배치를_반복할_수록_커넥션_엑티브된_==커넥션_풀_개수가_점점_늘어나는==_모습_0" data-path="#배치를_반복할_수록_커넥션_엑티브된_==커넥션_풀_개수가_점점_늘어나는==_모습_0"><div class="tree-item-inner heading-link" heading-name="배치를 반복할 수록 커넥션 엑티브된 ==커넥션 풀 개수가 점점 늘어나는== 모습">배치를 반복할 수록 커넥션 엑티브된 <mark>커넥션 풀 개수가 점점 늘어나는</mark> 모습</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#원인?_0" data-path="#원인?_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="원인?">원인?</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#앤티티_매니저가_클로즈_되었음에도_커넥션풀을_물고있는_모습._0" data-path="#앤티티_매니저가_클로즈_되었음에도_커넥션풀을_물고있는_모습._0"><div class="tree-item-inner heading-link" heading-name="앤티티 매니저가 클로즈 되었음에도 커넥션풀을 물고있는 모습.">앤티티 매니저가 클로즈 되었음에도 커넥션풀을 물고있는 모습.</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#***_**엔티티_매니저는_클로즈_될_때,_트렌젝션이_살아있다면_그_트렌젝션이_종료될때까지_기다린다**_0" data-path="#***_**엔티티_매니저는_클로즈_될_때,_트렌젝션이_살아있다면_그_트렌젝션이_종료될때까지_기다린다**_0"><div class="tree-item-inner heading-link" heading-name="*** **엔티티 매니저는 클로즈 될 때, 트렌젝션이 살아있다면 그 트렌젝션이 종료될때까지 기다린다**"><strong>* </strong>엔티티 매니저는 클로즈 될 때, 트렌젝션이 살아있다면 그 트렌젝션이 종료될때까지 기다린다**</div></a><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><a class="tree-item-self is-clickable mod-collapsible" href="project/hello-batch/spring-batch-트러블-슈팅.html#수정_후_0" data-path="#수정_후_0"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><div class="tree-item-inner heading-link" heading-name="수정 후">수정 후</div></a><div class="tree-item-children"><div class="tree-item" data-depth="3"><a class="tree-item-self is-clickable" href="project/hello-batch/spring-batch-트러블-슈팅.html#정상적으로_커넥션_풀이_점유_해제된_모습_0" data-path="#정상적으로_커넥션_풀이_점유_해제된_모습_0"><div class="tree-item-inner heading-link" heading-name="정상적으로 커넥션 풀이 점유 해제된 모습">정상적으로 커넥션 풀이 점유 해제된 모습</div></a><div class="tree-item-children"></div></div></div></div></div></div></div></div></div><script defer="">let rs = document.querySelector("#right-sidebar"); rs.classList.toggle("is-collapsed", window.innerWidth < 768); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></div></body></html>